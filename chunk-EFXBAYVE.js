import{a as re}from"./chunk-NA4BR2D6.js";import{a as ee,b as te}from"./chunk-GAH27JDS.js";import{a as v,g as z,h as k,m as J,n as Q,o as W,p as X,q as Y,s as Z,t as oe,u as ne,v as ie}from"./chunk-YXTKP4I4.js";import{$ as q,B,C as j,E as y,G,H as V,I as K,K as H,L as M,M as U,Q as A,T as R,X as $,y as I,z as _}from"./chunk-YBMRMBKT.js";import{$a as a,Aa as b,Ba as x,Ca as c,Da as o,Ea as n,Fa as u,Ja as D,La as m,M as d,Na as O,O as g,Ob as T,P as f,Xa as L,ab as E,ea as l,fb as N,ob as w,pa as C,ya as h,za as P}from"./chunk-TZHLYIMN.js";var S=class i{searchKey=w();gridCols=w();newPostClick=w();onClickGridCols(e){console.log("post-list-page-header says grid cols clicked: ",e),this.gridCols.emit(e)}onClickNewPost(){console.log("post-list-page-header says: new post clicked"),this.newPostClick.emit()}onSearchKey(e){this.searchKey.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=C({type:i,selectors:[["app-post-list-page-header"]],outputs:{searchKey:"searchKey",gridCols:"gridCols",newPostClick:"newPostClick"},decls:37,vars:2,consts:[["elementsMenu","matMenu"],["gridMenu","matMenu"],[1,"mat-toolbar-container"],[1,"mat-toolbar"],[1,"left-container"],["routerLink","/users"],["matIconName","arrow_back","matButtonContent","back","backGroundColor","#ADD8E6","textColor","#00008B","waveColor","#00008B"],[1,"right-container"],[3,"searchKey"],["matIconName","add","matButtonContent","New Post","backGroundColor","#C6D870","textColor","#556B2F","waveColor","#556B2F",1,"new-user-button",3,"click"],[1,"right-button-container"],["mat-icon-button","","aria-label","Example icon-button with a menu",1,"elements-button",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-icon-button","","aria-label","Example icon-button with share icon",1,"grid-button",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(t,r){if(t&1){let s=D();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"a",5),u(4,"app-custom-button",6),n()(),o(5,"div",7)(6,"app-custom-search",8),m("searchKey",function(me){return g(s),f(r.onSearchKey(me))}),n(),o(7,"app-custom-button",9),m("click",function(){return g(s),f(r.onClickNewPost())}),n(),o(8,"div",10)(9,"button",11)(10,"mat-icon"),a(11,"more_vert"),n()(),o(12,"mat-menu",null,0)(14,"button",12)(15,"span"),a(16,"10 elementi"),n()(),o(17,"button",12)(18,"span"),a(19,"20 elementi"),n()(),o(20,"button",12)(21,"span"),a(22,"30 elementi"),n()()(),o(23,"button",13)(24,"mat-icon"),a(25,"grid_view"),n()(),o(26,"mat-menu",null,1)(28,"button",14),m("click",function(){return g(s),f(r.onClickGridCols(1))}),o(29,"span"),a(30,"1 col"),n()(),o(31,"button",14),m("click",function(){return g(s),f(r.onClickGridCols(2))}),o(32,"span"),a(33,"2 cols"),n()(),o(34,"button",14),m("click",function(){return g(s),f(r.onClickGridCols(3))}),o(35,"span"),a(36,"3 cols"),n()()()()()()()}if(t&2){let s=L(13),p=L(27);l(9),c("matMenuTriggerFor",s),l(14),c("matMenuTriggerFor",p)}},dependencies:[k,M,z,q,Q,J,T,W,X],styles:[".mat-toolbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;padding:0 10px}.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;border-radius:12px;margin-top:15px;min-height:65px;width:99%;max-width:100%;box-shadow:0 2px 3px #0000004d;padding:8px 12px;flex-wrap:wrap}.left-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-shrink:0}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center;flex-wrap:wrap;gap:8px}.funct-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:stretch;gap:8px;flex-wrap:wrap}.new-user-button[_ngcontent-%COMP%]{margin:0}.right-button-container[_ngcontent-%COMP%]{display:flex;gap:5px}.elements-button[_ngcontent-%COMP%], .grid-button[_ngcontent-%COMP%]{box-shadow:0 2px 3px #0000004d;margin:0}@media (min-width: 410px) and (max-width: 640px){.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;padding:10px 8px}.left-container[_ngcontent-%COMP%]{width:100%;justify-content:center}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;gap:10px;margin-top:20px;margin-bottom:20px}.funct-container[_ngcontent-%COMP%]{width:100%;justify-content:center;gap:10px}.right-button-container[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 409px){.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;padding:10px 8px}.left-container[_ngcontent-%COMP%]{width:100%;justify-content:center}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;margin-top:20px;margin-bottom:20px}.funct-container[_ngcontent-%COMP%]{width:100%;justify-content:center;gap:10px}.right-button-container[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})};var pe=(i,e)=>e.id;function ce(i,e){if(i&1&&(o(0,"mat-option",3),a(1),n()),i&2){let t=e.$implicit;c("value",N(t.email)),l(),E(t.email)}}function de(i,e){i&1&&(o(0,"p",6),a(1,"*Invalid data"),n())}var F=class i{fb=d(H);dialogRef=d(Y);apiService=d(v);isInvalid=!1;userList=[];ngOnInit(){this.loadUsers()}loadUsers(){this.apiService.userList({}).subscribe(e=>{this.userList=e.body,console.log("create-post-dialog says: loaded users",this.userList)})}newPostForm=this.fb.group({userName:new y("",[_.required]),title:new y("",[_.required]),body:new y("",[_.maxLength(1e3),_.required])});submitData(){if(this.newPostForm.invalid){console.log("new-poster-dialog says: form invalid"),this.isInvalid=!0;return}this.isInvalid=!1,console.log("new-poster-dialog says: ",this.newPostForm);let t={user_id:this.userList?.find(r=>r.email===this.newPostForm.value.userName)?.id,title:this.newPostForm.value.title,body:this.newPostForm.value.body};console.log("new-poster-dialog-says: post created",t),this.dialogRef.close(t)}clearForm(){this.newPostForm.reset()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=C({type:i,selectors:[["app-create-post-dialog"]],decls:22,vars:2,consts:[[1,"new-post-form",3,"formGroup"],["appearance","outline"],["formControlName","userName"],[3,"value"],["matInput","","formControlName","title"],["matInput","","formControlName","body"],[2,"color","#BA1A1A"],[1,"form-button-group"],["matIconName","add","matButtonContent","Add","backGroundColor","#C6D870","textColor","#556B2F","waveColor","#556B2F",1,"add-button",3,"click"],["matIconName","delete","matButtonContent","Clear","backGroundColor","#FFD9E1","textColor","#8F0045","waveColor","#8F0045",1,"clear-button",3,"click"]],template:function(t,r){t&1&&(o(0,"app-custom-dialog-container")(1,"p"),a(2,"Insert new Post"),n(),o(3,"form",0)(4,"mat-form-field",1)(5,"mat-label"),a(6,"Username"),n(),o(7,"mat-select",2),b(8,ce,2,3,"mat-option",3,pe),n()(),o(10,"mat-form-field",1)(11,"mat-label"),a(12,"Title"),n(),u(13,"input",4),n(),o(14,"mat-form-field",1)(15,"mat-label"),a(16,"Body"),n(),u(17,"input",5),n()(),h(18,de,2,0,"p",6),o(19,"div",7)(20,"app-custom-button",8),m("click",function(){return r.submitData()}),n(),o(21,"app-custom-button",9),m("click",function(){return r.clearForm()}),n()()()),t&2&&(l(3),c("formGroup",r.newPostForm),l(5),x(r.userList),l(10),P(r.isInvalid?18:-1))},dependencies:[k,oe,M,G,I,B,j,R,$,A,ee,te,U,V,K],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.new-post-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-button-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;margin-bottom:20px}.add-button[_ngcontent-%COMP%], .clear-button[_ngcontent-%COMP%]{margin:0 10px}"]})};var ue=(i,e)=>e.id;function ge(i,e){i&1&&(o(0,"div",1)(1,"h2"),a(2,"No match found"),n()())}function fe(i,e){if(i&1&&u(0,"app-user-post-card",3),i&2){let t=e.$implicit;c("post",t)}}function Ce(i,e){if(i&1&&(o(0,"app-custom-grid",2),b(1,fe,1,1,"app-user-post-card",3,ue),n()),i&2){let t=O();c("gridCols",t.gridCols),l(),x(t.filteredPosts)}}var le=class i{apiService=d(v);dialog=d(Z);snackBar=d(ne);posts=[];filteredPosts=[];page=1;per_page=10;total=0;name;email;gridCols=2;isLoading=!0;ngOnInit(){console.log("PostListComponent says: initialized"),this.load()}load(){this.apiService.getPostList({page:this.page,per_page:this.per_page,name:this.name??"",email:this.email??""}).subscribe(e=>{this.posts=e.body??[],this.filteredPosts=this.posts,this.total=Number(e.headers.get("x-Pagination-Total")??0),this.isLoading=!1,console.log("post-list-component says: ",this.posts)})}onClickGridCols(e){console.log("post-list-component says grid cols clicked: ",e),this.gridCols=e}onClickNewPost(){console.log("post-list-component says: new post clicked"),this.openCreatePostDialog()}openCreatePostDialog(){console.log("post-list-component says: open create post dialog"),this.dialog.open(F).afterClosed().subscribe(e=>{console.log("post-list-component says: dialog closed with data: ",e),e&&this.apiService.addUserPost(e).subscribe({next:()=>{this.snackBar.open("Post created successfully","OK",{duration:3e3}),this.load()},error:t=>{let r=t?.error?.message||"Creation error";this.snackBar.open(r,"Chiudi",{duration:3e3})}})})}onSearchKeyValue(e){if(console.log("post-list says: searching for key ",e),!e||e.length===0){this.filteredPosts=this.posts;return}this.filteredPosts=this.posts.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.body.toLowerCase().includes(e.toLowerCase()))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=C({type:i,selectors:[["app-post-list"]],decls:3,vars:1,consts:[[3,"gridCols","newPostClick","searchKey"],[2,"display","flex","justify-content","center","align-items","center","height","50vh"],[3,"gridCols"],[3,"post"]],template:function(t,r){t&1&&(o(0,"app-post-list-page-header",0),m("gridCols",function(p){return r.onClickGridCols(p)})("newPostClick",function(){return r.onClickNewPost()})("searchKey",function(p){return r.onSearchKeyValue(p)}),n(),h(1,ge,3,0,"div",1)(2,Ce,3,1,"app-custom-grid",2)),t&2&&(l(),P(r.filteredPosts.length===0&&!r.isLoading?1:2))},dependencies:[ie,re,S],encapsulation:2})};export{le as PostListComponent};
