import{a as le}from"./chunk-S4C4XEJS.js";import"./chunk-MS4AQ6UA.js";import{a as S,f as W,g as X,h as Y,i as Z,j as ee,l as te,m as oe,n as ne,o as ie,p as re,q as ae,r as se}from"./chunk-YYN3VUP3.js";import{a as Q,c as D}from"./chunk-EXW6ZDO3.js";import{a as j,b as _,d as G,e as V,g as M,i as K,j as z,k as U,m as H,n as k,o as A,p as R,s as $,w as q}from"./chunk-QSLSHPGL.js";import{J}from"./chunk-3672ZLHB.js";import{$a as I,Ba as P,Ca as b,Ea as x,Fa as y,Ga as c,Ha as n,Ia as i,Ja as g,N as d,Na as N,P as u,Pa as l,Q as f,Ra as O,Tb as B,X as C,db as a,eb as T,ga as p,jb as E,pb as w,ra as h,sb as v}from"./chunk-B7UG6L7Y.js";var F=class r{searchKey=v();gridCols=v();newPostClick=v();onClickGridCols(e){console.log("post-list-page-header says grid cols clicked: ",e),this.gridCols.emit(e)}onClickNewPost(){console.log("post-list-page-header says: new post clicked"),this.newPostClick.emit()}onSearchKey(e){this.searchKey.emit(e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["app-post-list-page-header"]],outputs:{searchKey:"searchKey",gridCols:"gridCols",newPostClick:"newPostClick"},decls:23,vars:1,consts:[["gridMenu","matMenu"],[1,"mat-toolbar-container"],[1,"mat-toolbar"],[1,"left-container"],["routerLink","/users"],["matIconName","contacts","matButtonContent","See all Users","backGroundColor","#ADD8E6","textColor","#00008B","waveColor","#00008B"],[1,"right-container"],[3,"searchKey"],["matIconName","add","matButtonContent","New Post","backGroundColor","#C6D870","textColor","#556B2F","waveColor","#556B2F",1,"new-user-button",3,"click"],[1,"right-button-container"],["mat-icon-button","","aria-label","Example icon-button with share icon",1,"grid-button",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(t,o){if(t&1){let s=N();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"a",4),g(4,"app-custom-button",5),i()(),n(5,"div",6)(6,"app-custom-search",7),l("searchKey",function(de){return u(s),f(o.onSearchKey(de))}),i(),n(7,"app-custom-button",8),l("click",function(){return u(s),f(o.onClickNewPost())}),i(),n(8,"div",9)(9,"button",10)(10,"mat-icon"),a(11,"grid_view"),i()(),n(12,"mat-menu",null,0)(14,"button",11),l("click",function(){return u(s),f(o.onClickGridCols(1))}),n(15,"span"),a(16,"1 col"),i()(),n(17,"button",11),l("click",function(){return u(s),f(o.onClickGridCols(2))}),n(18,"span"),a(19,"2 cols"),i()(),n(20,"button",11),l("click",function(){return u(s),f(o.onClickGridCols(3))}),n(21,"span"),a(22,"3 cols"),i()()()()()()()}if(t&2){let s=I(13);p(9),c("matMenuTriggerFor",s)}},dependencies:[D,k,Q,J,X,W,B,Y,Z],styles:[".mat-toolbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;padding:0 10px}.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;border-radius:12px;margin-top:15px;min-height:65px;width:99%;max-width:100%;box-shadow:0 2px 3px #0000004d;padding:8px 12px;flex-wrap:wrap}.left-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-shrink:0}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center;flex-wrap:wrap;gap:8px}.funct-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:stretch;gap:8px;flex-wrap:wrap}.new-user-button[_ngcontent-%COMP%]{margin:0}.right-button-container[_ngcontent-%COMP%]{display:flex;gap:5px}.elements-button[_ngcontent-%COMP%], .grid-button[_ngcontent-%COMP%]{box-shadow:0 2px 3px #0000004d;margin:0}@media (min-width: 410px) and (max-width: 640px){.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;padding:10px 8px}.left-container[_ngcontent-%COMP%]{width:100%;justify-content:center}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center;gap:10px;margin-top:20px;margin-bottom:20px}.funct-container[_ngcontent-%COMP%]{width:100%;justify-content:center;gap:10px}.right-button-container[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 409px){.mat-toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;padding:10px 8px}.left-container[_ngcontent-%COMP%]{width:100%;justify-content:center}.right-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;margin-top:20px;margin-bottom:20px}.funct-container[_ngcontent-%COMP%]{width:100%;justify-content:center;gap:10px}.right-button-container[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})};var ge=(r,e)=>e.id;function ue(r,e){if(r&1&&(n(0,"mat-option",3),a(1),i()),r&2){let t=e.$implicit;c("value",E(t.email)),p(),T(t.email)}}function fe(r,e){r&1&&(n(0,"p",6),a(1,"*Invalid data"),i())}var L=class r{fb=d(H);dialogRef=d(ee);apiService=d(S);isInvalid=!1;userList=[];ngOnInit(){this.loadUsers()}loadUsers(){this.apiService.userList({}).subscribe(e=>{this.userList=e.body,console.log("create-post-dialog says: loaded users",this.userList)})}newPostForm=this.fb.group({userName:new M("",[_.required]),title:new M("",[_.required]),body:new M("",[_.maxLength(1e3),_.required])});submitData(){if(this.newPostForm.invalid){console.log("new-poster-dialog says: form invalid"),this.isInvalid=!0;return}this.isInvalid=!1,console.log("new-poster-dialog says: ",this.newPostForm);let t={user_id:this.userList?.find(o=>o.email===this.newPostForm.value.userName)?.id,title:this.newPostForm.value.title,body:this.newPostForm.value.body};console.log("new-poster-dialog-says: post created",t),this.dialogRef.close(t)}clearForm(){this.newPostForm.reset()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["app-create-post-dialog"]],decls:22,vars:2,consts:[[1,"new-post-form",3,"formGroup"],["appearance","outline"],["formControlName","userName"],[3,"value"],["matInput","","formControlName","title"],["matInput","","formControlName","body"],[2,"color","#BA1A1A"],[1,"form-button-group"],["matIconName","add","matButtonContent","Add","backGroundColor","#C6D870","textColor","#556B2F","waveColor","#556B2F",1,"add-button",3,"click"],["matIconName","delete","matButtonContent","Clear","backGroundColor","#FFD9E1","textColor","#8F0045","waveColor","#8F0045",1,"clear-button",3,"click"]],template:function(t,o){t&1&&(n(0,"app-custom-dialog-container")(1,"p"),a(2,"Insert new Post"),i(),n(3,"form",0)(4,"mat-form-field",1)(5,"mat-label"),a(6,"Username"),i(),n(7,"mat-select",2),x(8,ue,2,3,"mat-option",3,ge),i()(),n(10,"mat-form-field",1)(11,"mat-label"),a(12,"Title"),i(),g(13,"input",4),i(),n(14,"mat-form-field",1)(15,"mat-label"),a(16,"Body"),i(),g(17,"input",5),i()(),P(18,fe,2,0,"p",6),n(19,"div",7)(20,"app-custom-button",8),l("click",function(){return o.submitData()}),i(),n(21,"app-custom-button",9),l("click",function(){return o.clearForm()}),i()()()),t&2&&(p(3),c("formGroup",o.newPostForm),p(5),y(o.userList),p(10),b(o.isInvalid?18:-1))},dependencies:[D,ie,k,K,j,G,V,$,q,R,oe,ne,A,z,U],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.new-post-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-button-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;margin-bottom:20px}.add-button[_ngcontent-%COMP%], .clear-button[_ngcontent-%COMP%]{margin:0 10px}"]})};var Ce=(r,e)=>e.id;function he(r,e){r&1&&(n(0,"div",1)(1,"h2"),a(2,"No match found"),i()())}function _e(r,e){if(r&1&&g(0,"app-user-post-card",4),r&2){let t=e.$implicit;c("post",t)}}function Pe(r,e){if(r&1&&(n(0,"app-custom-grid",2),x(1,_e,1,1,"app-user-post-card",4,Ce),i()),r&2){let t=O();c("gridCols",t.gridCols()),p(),y(t.filteredPosts())}}var ce=class r{apiService=d(S);dialog=d(te);snackBar=d(re);allPosts=C([]);searchTerm=C("");pageIndex=C(0);pageSize=C(5);gridCols=C(2);isLoading=!0;get page(){return this.pageIndex()}get per_page(){return this.pageSize()}searchedPosts=w(()=>{let e=this.searchTerm().toLowerCase();return e?this.allPosts().filter(t=>t.title.includes(e)||t.body.includes(e)):this.allPosts()});filteredPosts=w(()=>{let e=this.searchedPosts(),t=this.pageSize()*this.pageIndex(),o=t+this.pageSize();return e.slice(t,o)});total=w(()=>this.searchedPosts().length);ngOnInit(){console.log("PostListComponent says: initialized"),this.load()}load(){this.apiService.getPostList({page:this.page,per_page:this.per_page,name:"",email:""}).subscribe({next:e=>{this.allPosts.set(e.body??[]),console.log("post-list-component says: ",this.allPosts)},complete:()=>{this.isLoading=!1}})}onClickGridCols(e){console.log("post-list-component says grid cols clicked: ",e),this.gridCols.set(e)}onClickNewPost(){console.log("post-list-component says: new post clicked"),this.openCreatePostDialog()}openCreatePostDialog(){console.log("post-list-component says: open create post dialog"),this.dialog.open(L).afterClosed().subscribe(e=>{console.log("post-list-component says: dialog closed with data: ",e),e&&this.apiService.addUserPost(e).subscribe({next:()=>{this.snackBar.open("Post created successfully","OK",{duration:3e3}),this.load()},error:t=>{let o=t?.error?.message||"Creation error";this.snackBar.open(o,"Chiudi",{duration:3e3})}})})}onSearchKeyValue(e){this.searchTerm.set(e),this.pageIndex.set(0),console.log("post-list says: searching for key ",e)}onPageChange(e){this.pageIndex.set(e.pageIndex),this.pageSize.set(e.pageSize),console.log("post-list says: page changed ",e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["app-post-list"]],decls:4,vars:3,consts:[[3,"gridCols","newPostClick","searchKey"],[2,"display","flex","justify-content","center","align-items","center","height","50vh"],[3,"gridCols"],[3,"pageChange","pageSize","length"],[3,"post"]],template:function(t,o){t&1&&(n(0,"app-post-list-page-header",0),l("gridCols",function(m){return o.onClickGridCols(m)})("newPostClick",function(){return o.onClickNewPost()})("searchKey",function(m){return o.onSearchKeyValue(m)}),i(),P(1,he,3,0,"div",1)(2,Pe,3,1,"app-custom-grid",2),n(3,"app-custom-paginator",3),l("pageChange",function(m){return o.onPageChange(m)}),i()),t&2&&(p(),b(o.filteredPosts().length===0&&!o.isLoading?1:2),p(2),c("pageSize",o.per_page)("length",o.total()))},dependencies:[ae,le,F,se],styles:["[_nghost-%COMP%]{display:block;padding-bottom:100px}@media (max-width: 479px){[_nghost-%COMP%]{padding-bottom:120px}}@media (min-width: 480px) and (max-width: 767px){[_nghost-%COMP%]{padding-bottom:110px}}"]})};export{ce as PostListComponent};
